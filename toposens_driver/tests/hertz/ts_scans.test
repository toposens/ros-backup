<launch>
  <arg name="sensor_port" default="tty7" />
  <arg name="driver_port" default="tty8" />

  <node pkg="toposens_driver" type="toposens_driver_mock"
        name="tty_emulator" args="$(arg sensor_port) $(arg driver_port)" />

  <node pkg="toposens_driver" type="toposens_driver_node" name="ts_driver_node">
    <param name="port" value="$(arg driver_port)" />
  </node>

  <node pkg="rosbag" type="play" name="player" output="screen"
        args="--clock $(find toposens_driver)/tests/ts_scans.bag" />

  <!-- Hz Test-->
  <!-- Tests publishing rate of topics-->
  <test pkg="rostest" type="hztest" test-name="ScansFrequency">
    <param name="topic" value="/ts_scans"/>
    <param name="hz" value="10.0"/>
    <param name="hzerror" value="1.0"/>
    <param name="test_duration" value="5.0"/>
  </test>
</launch>